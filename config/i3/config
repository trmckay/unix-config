# VARIABLES
set $TERMINAL   alacritty
set $WEBBROWSER firefox
set $SHELL      zsh

set $SCRIPT_DIR "~/scripts"

set $PRIMARY    HDMI-0
set $SECONDARY  DP-3
set $MOD        Mod4

# GENERAL
floating_modifier $MOD
popup_during_fullscreen leave_fullscreen

# STYLE
gaps inner 10
gaps outer 5

default_border pixel
new_float none

font Meslo LG S
font pango: Meslo LG S 10

set $COLOR_1  #66a590
set $COLOR_2  #88fc8c
set $COLOR_FG #66a590
set $COLOR_BG #101010

# class                 border    backgr.   text      indicator child_border
client.focused          $COLOR_1  $COLOR_1  $COLOR_FG $COLOR_FG $COLOR_1
client.focused_inactive $COLOR_BG $COLOR_BG $COLOR_FG $COLOR_FG $COLOR_BG
client.unfocused        $COLOR_BG $COLOR_BG $COLOR_FG $COLOR_FG $COLOR_BG
client.urgent           $COLOR_2  $COLOR_2  $COLOR_FG $COLOR_FG $COLOR_2

client.background       $COLOR_BG

# FLOATING
for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_role="Preferences"] floating enable
for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable

for_window [class="mpv"] floating enable
for_window [class="feh"] floating enable
for_window [class="MuPDF"] floating enable, move to workspace $wsa

for_window [title="mpv-theater-view"] move to workspace $wsa, fullscreen

# APP SHORTCUTS
bindsym $MOD+w exec $WEBBROWSER

bindsym $MOD+i exec thunderbird

bindsym $MOD+s exec spotify

bindsym $MOD+Return exec "$TERMINAL"
bindsym $MOD+shift+Return exec "$TERMINAL -e tmux"

bindsym $MOD+p exec --no-startup-id "$TERMINAL --title pulsemixer-popup -e pulsemixer"
for_window [title="pulsemixer-popup"] floating enable, position center

bindsym $MOD+n exec --no-startup-id "$TERMINAL --title nmtui-popup -e nmtui"
for_window [title="nmtui-popup"] floating enable, position center

bindsym $MOD+t exec --no-startup-id "$TERMINAL --title task-popup -e vit"
for_window [title="task-popup"] floating enable, position center

bindsym $MOD+e exec --no-startup-id "$TERMINAL --title ranger-popup -e ranger"
for_window [title="ranger-popup"] floating enable, position 0 0

bindsym $MOD+u exec --no-startup-id "$TERMINAL --title htop-popup -e htop"
for_window [title="htop-popup"] fullscreen

bindsym $MOD+c exec --no-startup-id "gscreenshot"
for_window [title="gscreenshot"] floating enable, position center

bindsym $MOD+x exec "$HOME/dotfiles/i3/quickterm/i3-quickterm shell"

bindsym $MOD+space exec "rofi -show drun"

# MUSIC SHORTCUTS
mode "music shortcuts" {
    bindsym k exec "$SCRIPT_DIR/listen.sh kusc", mode default
    bindsym l exec "$SCRIPT_DIR/listen.sh lofi", mode default
    bindsym j exec "$SCRIPT_DIR/listen.sh jazz", mode default
    bindsym q exec "$SCRIPT_DIR/listen.sh", mode default

    bindsym enter mode default
    bindsym escape mode default
}
bindsym $MOD+shift+m mode "music shortcuts"

# WEB SHORTCUTS
mode "web shortcuts" {
    bindsym c exec "$WEBBROWSER -new-window https://calendar.google.com", mode "default"
    bindsym g exec "$WEBBROWSER -new-window https://github.com/trmckay", mode "default"
    bindsym d exec "$WEBBROWSER -new-window https://www.discover.com", mode "default"
    bindsym y exec "$WEBBROWSER -new-window https://www.youtube.com/feed/subscriptions", mode "default"
    bindsym a exec "$WEBBROWSER -new-window https://www.atlantic.com", mode "default"
    bindsym t exec "$WEBBROWSER -new-window https://www.nyt.com", mode "default"
    bindsym e exec "$WEBBROWSER -new-window https://www.economist.com", mode "default"
    bindsym p exec "$WEBBROWSER -new-window https://my.calpoly.edu", mode "default"
    bindsym i exec "$WEBBROWSER -new-window https://canvas.calpoly.edu", mode "default"
    bindsym l exec "$WEBBROWSER -new-window https://leo.org", mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $MOD+o mode "web shortcuts"

# WORKSPACES
set $ws1 "1"
set $ws2 "2"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"

workspace $ws1 output $PRIMARY
workspace $ws2 output $PRIMARY
workspace $ws3 output $PRIMARY
workspace $ws4 output $PRIMARY
workspace $ws5 output $PRIMARY
workspace $ws6 output $PRIMARY
workspace $ws7 output $PRIMARY
workspace $ws8 output $PRIMARY
workspace $ws9 output $PRIMARY


# SHORTCUTS
bindsym $MOD+q kill

bindsym $MOD+Shift+v split h
bindsym $MOD+v split v

bindsym $MOD+shift+h move left
bindsym $MOD+shift+j move down
bindsym $MOD+shift+k move up
bindsym $MOD+shift+l move right

bindsym $MOD+h focus left
bindsym $MOD+j focus down
bindsym $MOD+k focus up
bindsym $MOD+l focus right

bindsym $MOD+Mod1+j resize shrink height 10 px or 10 ppt
bindsym $MOD+Mod1+k resize grow   height 10 px or 10 ppt
bindsym $MOD+Mod1+h resize shrink width  10 px or 10 ppt
bindsym $MOD+Mod1+l resize grow   width  10 px or 10 ppt

bindsym $MOD+f fullscreen toggle

bindsym $MOD+z focus mode_toggle

bindsym $MOD+m exec i3-input -F 'mark %s' -l 1 -P 'Mark: '
bindsym $MOD+g exec i3-input -F '[con_mark="%s"] focus' -l 1 -P 'Goto: '

bindsym $MOD+period exec "playerctl next"
bindsym $MOD+comma exec "playerctl previous"
bindsym $MOD+slash exec "playerctl play-pause"

bindsym $MOD+Shift+c reload
bindsym $MOD+Shift+r restart

set $mode_system System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (Shift+s) shutdown
mode "$mode_system" {
    bindsym l exec --no-startup-id i3exit lock, mode "default"
    bindsym e exec --no-startup-id i3exit logout, mode "default"
    bindsym s exec --no-startup-id i3exit suspend, mode "default"
    bindsym h exec --no-startup-id i3exit hibernate, mode "default"
    bindsym r exec --no-startup-id i3exit reboot, mode "default"
    bindsym Shift+s exec --no-startup-id i3exit shutdown, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $MOD+shift+q mode "$mode_system"

bindsym $MOD+shift+f floating toggle

bindsym $MOD+1 workspace number $ws1
bindsym $MOD+2 workspace number $ws2
bindsym $MOD+3 workspace number $ws3
bindsym $MOD+4 workspace number $ws4
bindsym $MOD+5 workspace number $ws5
bindsym $MOD+6 workspace number $ws6
bindsym $MOD+7 workspace number $ws7
bindsym $MOD+8 workspace number $ws8
bindsym $MOD+9 workspace number $ws9

bindsym $MOD+Shift+1 move container to workspace number $ws1
bindsym $MOD+Shift+2 move container to workspace number $ws2
bindsym $MOD+Shift+3 move container to workspace number $ws3
bindsym $MOD+Shift+4 move container to workspace number $ws4
bindsym $MOD+Shift+5 move container to workspace number $ws5
bindsym $MOD+Shift+6 move container to workspace number $ws6
bindsym $MOD+Shift+7 move container to workspace number $ws7
bindsym $MOD+Shift+8 move container to workspace number $ws8
bindsym $MOD+Shift+9 move container to workspace number $ws9

mode "secondary" {
        bindsym 1 workspace $wsa, mode default
        bindsym 2 workspace $wsb, mode default
        bindsym 3 workspace $wsc, mode default
        bindsym 4 workspace $wsa, mode default

        bindsym Shift+1 move container to workspace $wsa
        bindsym Shift+2 move container to workspace $wsb
        bindsym Shift+3 move container to workspace $wsc
        bindsym Shift+4 move container to workspace $wsd

        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $MOD+r mode "default"
}
bindsym $MOD+Tab mode "secondary"

# MACHINE SPECIFIC

exec --no-startup-id nitrogen --restore                         # wallpaper
exec --no-startup-id $HOME/.config/polybar/launch.sh            # status bar
exec --no-startup-id picom -b -c                                # compositor
exec --no-startup-id dunst                                      # notifications
exec --no-startup-id xautolock -time 15 -locker "i3exit lock"   # locker

set $wsa "a"
set $wsb "b"
set $wsc "c"
set $wsd "d"

workspace $wsa output $SECONDARY
workspace $wsb output $SECONDARY
workspace $wsc output $SECONDARY
workspace $wsd output $SECONDARY
